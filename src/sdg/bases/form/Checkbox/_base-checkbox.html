<h2 id="checkbox">Cases à cocher</h2>

<p>Le composant de case à cocher permet de créer des éléments de formulaire pour la sélection multiple. Il peut être utilisé seul ou en groupe.</p>

<qc-doc-exemple caption="Exemple d’une case à cocher seule obligatoire">
  <form id="base-exemple-tos-form">
    <div class="qc-checkbox-single">
      <label class="qc-check-row" for="base-exemple-une-case">
        <input
          id="base-exemple-une-case"
          type="checkbox"
          value="oui"
          name="base-consentement"
          aria-required="true"
          aria-invalid="false"
        >
        <span class="qc-check-text">
          <span class="qc-check-label">
            J’accepte les conditions d’utilisation
            <span class="qc-required">*</span>
          </span>
        </span>
      </label>

      <div class="qc-form-error" role="alert">
        <div role="img"
             class="qc-icon"
             data-img-type="warning"
             style="--img-color: var(--qc-color-red-regular);
                    --img-width: 24px;
                    --img-height: 21px;
                    display: none;
                    "
        ></div>
        <span class="qc-form-error-message" hidden>Le champ "J'accepte les conditions d'utilisation" est obligatoire.</span>
      </div>
    </div>

    <button class="btn btn-sm btn-primary"
            type="submit">
      S'inscrire
    </button>
  </form>

  <script>
    const tosForm = document.getElementById("base-exemple-tos-form");
    const termsAcceptance = document.getElementById("base-exemple-une-case")
    tosForm.addEventListener("submit", (event) => {
      event.preventDefault();
      if(termsAcceptance.checked) {
        const formData = new FormData(event.target);
        let alertParts = ["Formulaire soumis avec les données suivantees :"];
        for (const [key, value] of formData.entries()) {
          alertParts.push(`${key} : ${value}`);
        }
        alert(alertParts.join("\n"));
      } else {
        termsAcceptance.invalid = true;
        tosForm.querySelector(".qc-checkbox-single").classList.add("qc-checkbox-single-invalid");
        tosForm.querySelector(".qc-form-error-message")?.removeAttribute("hidden");
        tosForm.querySelector(".qc-icon").style.display = "flex";
      }
    })

    termsAcceptance.addEventListener("change", () => {
      tosForm.querySelector(".qc-checkbox-single").classList.remove("qc-checkbox-single-invalid");
      termsAcceptance.invalid = false;
      tosForm.querySelector(".qc-form-error-message")?.setAttribute("hidden", "");
      tosForm.querySelector(".qc-icon").style.display = "none";
    });
  </script>
</qc-doc-exemple>

<qc-doc-exemple caption="Exemple d’un groupe de cases à cocher avec différents états">
  <fieldset aria-describedby="base-legend-895684" class="qc-fieldset" data-required="true">
    <legend id="base-legend-895684">Sélectionnez vos options</legend>
    <div class="qc-field-elements-flex qc-field-elements-flex-sm" style="--column-count: 1;">
      <label class="qc-check-row" for="base-Option 1-kf8af3zoax">
        <input type="checkbox" name="base-checkbox-group" value="Option 1" id="base-Option 1-kf8af3zoax" aria-required="false" aria-invalid="false">
        <span class="qc-check-text">
          <span class="qc-check-label">Option 1</span>
        </span>
      </label>


      <label class="qc-check-row" for="base-Option 2 cochée par défaut-6dtqm2cbwna">
        <input type="checkbox" name="base-checkbox-group" value="Option 2 cochée par défaut" id="base-Option 2 cochée par défaut-6dtqm2cbwna" aria-required="false" aria-invalid="false" checked>
        <span class="qc-check-text">
          <span class="qc-check-label">Option 2 cochée par défaut</span>
        </span>
      </label>

      <label class="qc-check-row" for="base-Option 3 désactivée-8plxpo1egnp">
        <input type="checkbox" name="base-checkbox-group" value="Option 3 désactivée" id="base-Option 3 désactivée-8plxpo1egnp" disabled="" aria-required="false" aria-invalid="false">
        <span class="qc-check-text">
          <span class="qc-check-label">Option 3 désactivée</span>
        </span>
      </label>
    </div>
  </fieldset>
</qc-doc-exemple>

<qc-doc-exemple caption="Exemple d’un groupe de cases à cocher au petit format">
  <fieldset aria-describedby="base-legend-compact" class="qc-fieldset">
    <legend id="base-legend-compact">Sélectionnez vos options</legend>
    <div class="qc-field-elements-flex qc-field-elements-flex-sm" style="--column-count: 1;">
      <label class="qc-check-row" for="base-Option 1-compact">
        <input type="checkbox" name="base-checkbox-group" value="Option 1" id="base-Option 1-compact" aria-required="false" aria-invalid="false" class="qc-compact">
        <span class="qc-check-text">
          <span class="qc-check-label">Option 1</span>
        </span>
      </label>


      <label class="qc-check-row" for="base-Option 2 cochée par défaut-compact">
        <input type="checkbox" name="base-checkbox-group" value="Option 2 cochée par défaut" id="base-Option 2 cochée par défaut-compact" aria-required="false" aria-invalid="false" class="qc-compact">
        <span class="qc-check-text">
          <span class="qc-check-label">Option 2 cochée par défaut</span>
        </span>
      </label>

      <label class="qc-check-row" for="base-Option 3 désactivée-compact">
        <input type="checkbox" name="base-checkbox-group" value="Option 3 désactivée" id="base-Option 3 désactivée-compact" aria-required="false" aria-invalid="false" class="qc-compact">
        <span class="qc-check-text">
          <span class="qc-check-label">Option 3 désactivée</span>
        </span>
      </label>
    </div>
  </fieldset>
</qc-doc-exemple>

<qc-doc-exemple caption="Exemple de validation de formulaire avec des cases à cocher">
  <form id="base-checkbox-form">
    <fieldset aria-describedby="id_ex-checkbox-form" class="qc-fieldset" data-required="false">
      <legend id="id_ex-checkbox-form">
        Sur quelle plateforme consultez-vous www.quebec.ca?
        <span class="qc-required" aria-hidden="true">*</span>
      </legend>

      <div class="qc-field-elements-flex qc-field-elements-flex-sm" style="--column-count: 1;">
        <label class="qc-check-row" for="ex-checkbox-form-ordinateur-base">
          <input type="checkbox" value="ordinateur" name="base-ex-checkbox-form" id="ex-checkbox-form-ordinateur-base" aria-required="true" aria-invalid="false">
          <span class="qc-check-text">
            <span class="qc-check-label">Ordinateur</span>
          </span>
        </label>

        <label class="qc-check-row" for="ex-checkbox-form-tablette-base">
          <input type="checkbox" value="tablette" name="base-ex-checkbox-form" id="ex-checkbox-form-tablette-base" aria-required="true" aria-invalid="false">
          <span class="qc-check-text">
            <span class="qc-check-label">Tablette</span>
          </span>
        </label>

        <label class="qc-check-row" for="ex-checkbox-form-telephone_intelligent-base">
          <input type="checkbox" value="telephone_intelligent" name="base-ex-checkbox-form" id="ex-checkbox-form-telephone_intelligent-base" aria-required="true" aria-invalid="false">
          <span class="qc-check-text">
            <span class="qc-check-label">Téléphone intelligent</span>
          </span>
        </label>
      </div>
    </fieldset>

    <div class="qc-form-error" role="alert">
      <div role="img"
           class="qc-icon"
           data-img-type="warning"
           style="--img-color: var(--qc-color-red-regular);
                    --img-width: 24px;
                    --img-height: 21px;
                    display: none;
                    "
      ></div>
      <span class="qc-form-error-message" hidden>Veuillez sélectionner une plateforme.</span>
    </div>

    <fieldset aria-describedby="id_ex-checkbox-form-2" class="qc-fieldset">
      <legend id="id_ex-checkbox-form-2">Sur quel navigateur consultez-vous www.quebec.ca?</legend>

      <div class="qc-field-elements-flex qc-field-elements-flex-sm" style="--column-count: 1;">
        <label class="qc-check-row" for="ex-checkbox-form-2-chrome-51n8m5rxecg">
          <input type="checkbox" value="chrome" name="base-ex-checkbox-form-2" id="ex-checkbox-form-2-chrome-51n8m5rxecg" aria-required="false" aria-invalid="false">
          <span class="qc-check-text">
            <span class="qc-check-label">Chrome </span>
          </span>
        </label>

        <label class="qc-check-row" for="ex-checkbox-form-2-safari-hhai3z61kb8">
          <input type="checkbox" value="safari" name="base-ex-checkbox-form-2" id="ex-checkbox-form-2-safari-hhai3z61kb8" aria-required="false" aria-invalid="false">
          <span class="qc-check-text">
            <span class="qc-check-label">Safari</span>
          </span>
        </label>

        <label class="qc-check-row" for="ex-checkbox-form-2-firefox-mjzmiagh4p">
          <input type="checkbox" value="firefox" name="base-ex-checkbox-form-2" id="ex-checkbox-form-2-firefox-mjzmiagh4p" aria-required="false" aria-invalid="false">
          <span class="qc-check-text">
            <span class="qc-check-label">Firefox</span>
          </span>
        </label>
      </div>
    </fieldset>

    <button class="btn btn-sm btn-primary" type="submit">
      Soumettre
    </button>
  </form>

  <script>
    document
      .getElementById("base-checkbox-form")
      .addEventListener("submit", (event) => {
        event.preventDefault();
        let doSubmit = true;
        event.target.querySelectorAll("fieldset[data-required='true']").forEach(group => {
          if (!group.querySelectorAll("input:checked").length <= 0) {
            group.querySelectorAll("input").forEach(input => {
              input.ariaInvalid = true;
            });
            doSubmit = false;
          }
        })
        if(doSubmit) {
          const platformValues = Array.from(event.target.querySelectorAll("input[name='base-ex-checkbox-form']:checked")).map(input => input.value);
          const browserValues = Array.from(event.target.querySelectorAll("input[name='base-ex-checkbox-form-2']:checked")).map(input => input.value);

          alert(
            "Formulaire soumis\n"
                  + `Valeur pour 'Plateforme' : ${platformValues ? platformValues.join(',') : "vide"}`
                  + `\nValeur pour 'Navigateur' : ${browserValues ? browserValues.join(',') : "vide"}`
          );
        }
      })
  </script>
</qc-doc-exemple>


<h3>Documentation technique</h3>

<h4>Attributs de qc-checkbox</h4>
<div class="table-overflow">
  <table class="qc-table qc-striped component-attributes-description">
    <thead>
    <tr>
      <th>Nom</th>
      <th>Valeur attendue</th>
      <th>Valeur par défaut</th>
      <th>Description</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td>name</td>
      <td>Texte</td>
      <td>""</td>
      <td>Nom du champ de formulaire</td>
    </tr>
    <tr>
      <td>label</td>
      <td>Texte</td>
      <td>""</td>
      <td>Libellé de la case à cocher</td>
    </tr>
    <tr>
      <td>value</td>
      <td>Texte</td>
      <td>Valeur de l’attribut label</td>
      <td>Valeur du champ</td>
    </tr>
    <tr>
      <td>compact</td>
      <td>na</td>
      <td>na</td>
      <td>Affiche les boutons radios au format compact</td>
    </tr>
    <tr>
      <td>required</td>
      <td>na</td>
      <td>na</td>
      <td>Indique aux internautes que la sélection est obligatoire en ajoutant un astérisque dans la légende</td>
    </tr>
    <tr>
      <td>disabled</td>
      <td>na</td>
      <td>na</td>
      <td>Désactive le groupe</td>
    </tr>
    <tr>
      <td>invalid</td>
      <td>na</td>
      <td>na</td>
      <td>
        Indique si le groupe est dans un état invalide
        (ajuster cette valeur lors de la validation d’un formulaire, cf « Exemple d’une case à cocher seule obligatoire ».)
        <br/>NB : `invalid` prend automatiquement la valeur `false` dès qu’un bouton est coché.
      </td>
    </tr>
    <tr>
      <td>invalid-text</td>
      <td>Texte</td>
      <td>"Champ obligatoire" ou "Required field"</td>
      <td>Message d’erreur à afficher lorsque la case est invalide</td>
    </tr>
    </tbody>
  </table>
</div>


<h4>Attributs de qc-checkbox-group</h4>
<div class="table-overflow">
  <table class="qc-table qc-striped component-attributes-description">
    <thead>
    <tr>
      <th>Nom</th>
      <th>Valeur attendue</th>
      <th>Valeur par défaut</th>
      <th>Description</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td>legend</td>
      <td>Texte</td>
      <td>""</td>
      <td>Légende du groupe de cases à cocher</td>
    </tr>
    <tr>
      <td>name</td>
      <td>Texte</td>
      <td>""</td>
      <td>Nom commun pour toutes les cases à cocher du groupe</td>
    </tr>
    <tr>
      <td>compact</td>
      <td>na</td>
      <td>na</td>
      <td>Affiche les boutons radios au format compact</td>
    </tr>
    <tr>
      <td>required</td>
      <td>na</td>
      <td>na</td>
      <td>Indique aux internautes que la sélection est obligatoire en ajoutant un astérisque dans la légende</td>
    </tr>
    <tr>
      <td>disabled</td>
      <td>na</td>
      <td>na</td>
      <td>Désactive le groupe</td>
    </tr>
    <tr>
      <td>invalid</td>
      <td>na</td>
      <td>na</td>
      <td>
        Indique si le groupe est dans un état invalide
        (ajuster cette valeur lors de la validation d’un formulaire, cf « Exemple de validation de formulaire avec des cases à cocher ».)
        <br/>NB : `invalid` prend automatiquement la valeur `false` dès qu’un bouton est coché.
      </td>
    </tr>
    <tr>
      <td>invalid-text</td>
      <td>Texte</td>
      <td>"Champ obligatoire" ou "Required field"</td>
      <td>Message d’erreur à afficher lorsque le groupe est invalide</td>
    </tr>
    <tr>
      <td>checkbox-*</td>
      <td></td>
      <td></td>
      <td>
        Tout attribut commençant par <code class="qc-bg-color-grey-pale">checkbox-</code> sera ajouté
        comme attribut à la case à cocher.
      </td>
    </tr>
    </tbody>
  </table>
</div>