<h2 id="select">Liste déroulante</h2>

<h3>Exemples</h3>

<qc-doc-exemple caption="Exemple de listes déroulantes en sélection dans différents états">
    <qc-select id="qc-select-single-choice">
        <label for="select-single-choice">Choix unique</label>
        <select id="select-single-choice">
            <option value="1" selected>Option 1</option>
            <option value="2">Option 2</option>
            <option value="3">Option 3</option>
            <option value="4">Option 4</option>
            <option value="5">Option 5</option>
            <option value="6">Option 6</option>
            <option value="7">Option 7</option>
            <option value="8">Option 8</option>
            <option value="9">Option 9</option>
            <option value="10">Option 10</option>
            <option value="11">Option 11</option>
            <option value="12">Option 12</option>
            <option value="13">Option 13</option>
            <option value="14">Option 14</option>
            <option value="15">Option 15</option>
            <option value="16" disabled>Option 16 (désactivée)</option>
        </select>
    </qc-select>

    <qc-select id="qc-select-single-choice-search" enable-search>
        <label for="select-single-choice-search">Choix unique avec recherche</label>
        <select id="select-single-choice-search">
            <option value="1" selected>Option 1</option>
            <option value="2">Option 2</option>
            <option value="3">Option 3</option>
            <option value="4">Option 4</option>
            <option value="5">Option 5</option>
            <option value="6">Option 6</option>
            <option value="7">Option 7</option>
            <option value="8">Option 8</option>
            <option value="9">Option 9</option>
            <option value="10">Option 10</option>
            <option value="11">Option 11</option>
            <option value="12">Option 12</option>
            <option value="13">Option 13</option>
            <option value="14">Option 14</option>
            <option value="15">Option 15</option>
            <option value="16" >Option 16</option>
        </select>
    </qc-select>

    <qc-select id="qc-select-multiple-choices" multiple>
        <label for="select-multiple-choices">Choix multiples</label>
        <select multiple id="select-multiple-choices">
            <option value="1">Option 1</option>
            <option value="2" selected>Option 2</option>
            <option value="3" selected>Option 3</option>
            <option value="4">Option 4</option>
            <option value="5">Option 5</option>
            <option value="6">Option 6</option>
            <option value="7">Option 7</option>
            <option value="8">Option 8</option>
            <option value="9">Option 9</option>
            <option value="10">Option 10</option>
            <option value="11">Option 11</option>
            <option value="12">Option 12</option>
            <option value="13">Option 13</option>
            <option value="14">Option 14</option>
            <option value="15">Option 15</option>
            <option value="16" disabled>Option 16 (désactivée)</option>
        </select>
    </qc-select>

    <qc-select id="qc-select-disabled" disabled>
        <label for="select-disabled">Désactivé</label>
        <select id="select-disabled">disabled</select>
    </qc-select>

    <script>
        function mutationCallback(mutationsList, _) {
            mutationsList.forEach(mutation => {
                if (mutation.type === 'attributes') {
                    console.log(`Valeur de '${mutation.target.id}': ${mutation.target.value}`);
                }
            });
        }

        const mutationObserver = new MutationObserver(mutationCallback);

        const singleChoice = document.getElementById("qc-select-single-choice");
        const singleChoiceNoScroll = document.getElementById("qc-select-single-choice-search");
        const multipleChoice = document.getElementById("qc-select-multiple-choices");

        mutationObserver.observe(singleChoice, { attributes: true });
        mutationObserver.observe(singleChoiceNoScroll, { attributes: true });
        mutationObserver.observe(multipleChoice, { attributes: true });

        window.onbeforeunload = () => {
            mutationObserver.disconnect();
        }
    </script>
</qc-doc-exemple>

<qc-doc-exemple caption="Exemple de validation de formulaire avec listes déroulantes">
    <form id="dropdown-list-form">
        <qc-select
                id="dropdown-list-restaurants"
                placeholder="Types de restaurant"
                enable-search
                search-placeholder="Rechercher des types restaurant"
                required
                invalid-text="Veuillez choisir un type de restaurant."
        >
            <label for="dropdown-list-restaurants-select">Types de restaurants</label>
            <select id="dropdown-list-restaurants-select">
                <option value="Pizzeria">Pizzeria</option>
                <option value="Pâtisserie">Pâtisserie</option>
                <option value="Steakhouse">Steakhouse</option>
                <option value="Bar">Bar</option>
                <option value="Casse-croûte">Casse-croûte</option>
                <option value="Boîte à pâtes">Boîte à pâtes</option>
                <option value="Restaurant à burgers">Restaurant à burgers</option>
            </select>
        </qc-select>

        <qc-select
                id="dropdown-list-regions"
                placeholder="Sélectionner une région"
                width="lg"
                enable-search
                search-placeholder="Rechercher les régions"
                multiple
        >
            <label for="dropdown-list-regions-select">Régions desservies</label>
            <select id="dropdown-list-regions-select" multiple>
                <option value="Capitale-nationale">Capitale-nationale</option>
                <option value="Centre-du-Québec" selected>Centre-du-Québec</option>
                <option value="Montérégie" selected>Montérégie</option>
                <option value="Outaouais">Outaouais</option>
                <option value="Saguenay-Lac-Saint-Jean">Saguenay-Lac-Saint-Jean</option>
                <option value="Gaspésie-Îles-de-la-Madeleine">Gaspésie-Îles-de-la-Madeleine</option>
                <option value="Nord-du-Québec">Nord-du-Québec</option>
                <option value="Bas-Saint-Laurent">Bas-Saint-Laurent</option>
            </select>
        </qc-select>

        <button type="submit" class="qc-button qc-primary qc-compact">Envoyer</button>
    </form>

    <script>
        const dropdownListForm = document.getElementById("dropdown-list-form");

        dropdownListForm.addEventListener("submit", (event) => {
            event.preventDefault();

            let isValid = true;

            const requiredFields = dropdownListForm.querySelectorAll("qc-select[required]");
            console.log(requiredFields);

            requiredFields.forEach(field => {
                const value = field.value;

                if (!value) {
                    field.invalid = true;
                    isValid = false;
                } else {
                    field.invalid = false;
                }
            });

            if (isValid) {
                const formEntries = dropdownListForm.querySelectorAll("qc-select");
                let alertParts = ["Formulaire soumis avec les données suivantes :"];
                formEntries.forEach((field) => {
                    alertParts.push(`${field.label}: ${field.value.join(", ")}`);
                });
                alert(alertParts.join("\n"));
            }
        });
    </script>
</qc-doc-exemple>

<h3>Documentation technique</h3>

<h4>Attributs</h4>
<div class="table-overflow">
    <table class="qc-table qc-striped component-attributes-description">
        <thead>
        <tr>
            <th>Nom</th>
            <th>Valeur attendue</th>
            <th>Valeur par défaut</th>
            <th>Description</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>id</td>
            <td>Texte</td>
            <td>Chaîne de caractères aléatoire</td>
            <td>Identifiant de la liste déroulante</td>
        </tr>
        <tr>
            <td>label</td>
            <td>Contenu HTML</td>
            <td>""</td>
            <td>
                Libellé de la liste déroulante.
                <br> Si le libellé est absent, le contenu de l'élément <code>label</code> en slot est utilisé.
            </td>
        </tr>
        <tr>
            <td>width</td>
            <td>"xs", "sm", "md", "lg", "xl"</td>
            <td>"md"</td>
            <td>Largeur de la liste déroulante</td>
        </tr>
        <tr>
            <td>value</td>
            <td>Texte</td>
            <td></td>
            <td>Valeur(s) sélectionnée(s) dans la liste déroulante</td>
        </tr>
        <tr>
            <td>enable-search</td>
            <td>na</td>
            <td>na</td>
            <td>Affiche un champ de recherche dans le haut des options de la liste déroulante</td>
        </tr>
        <tr>
            <td>required</td>
            <td>na</td>
            <td>na</td>
            <td>Indique aux internautes que la sélection est obligatoire en ajoutant un astérisque dans le libellé</td>
        </tr>
        <tr>
            <td>disabled</td>
            <td>na</td>
            <td>na</td>
            <td>Désactive la liste déroulante</td>
        </tr>
        <tr>
            <td>invalid</td>
            <td>na</td>
            <td>na</td>
            <td>
                Indique si la liste déroulante est dans un état invalide
                <br/>NB : <code>invalid</code> prend automatiquement la valeur <code>false</code>
                dès que l'attribut <code>value</code> contient une donnée.
            </td>
        </tr>
        <tr>
            <td>invalid-text</td>
            <td>Texte</td>
            <td>Le champ `label` est obligatoire.</td>
            <td>Message d’erreur à afficher lorsque la liste déroulante est invalide</td>
        </tr>
        <tr>
            <td>placeholder</td>
            <td>Texte</td>
            <td>""</td>
            <td>Texte d'espace réservé de la boîte de la liste déroulante</td>
        </tr>
        <tr>
            <td>search-placeholder</td>
            <td>Texte</td>
            <td>""</td>
            <td>Texte d'espace réservé du champ de recherche</td>
        </tr>
        <tr>
            <td>no-options-message</td>
            <td>Contenu HTML</td>
            <td>Aucun élément/No item</td>
            <td>Texte indiquant l'absence d'options pouvant être affichées</td>
        </tr>
        <tr>
            <td>multiple</td>
            <td>na</td>
            <td>na</td>
            <td>
                Active la sélection multiple.
                <br> Si <code>multiple</code> est définie dans l'élément <code>select</code> en slot, cette valeur a
                priorité.
            </td>
        </tr>
        </tbody>
    </table>
</div>

<h3>Précision concernant le DOM d’ombre (Shadow dom)</h3>
<ul>
    <li>Ce composant contient un DOM d'ombre.</li>
    <li>
        Les éléments suivants sont à ajouter dans le slot pour que la liste déroulante s'affiche correctement :
        <ul>
            <li><code>label</code></li>
            <li><code>select</code></li>
        </ul>
    </li>
</ul>